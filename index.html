<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />

<title>MOR Dashboard</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="When birds and planes collide...">
    <meta name="author" content="Jeffrey Shaffer">

  <!-- <link rel="stylesheet" href="leapstrap.css" /> -->
  <!-- <link rel="stylesheet" href="example.css" /> -->
	
	<script src="annyang.min.js"></script>
	<script src="responsivevoice.js"></script>

	<script src="https://public.tableausoftware.com/javascripts/api/tableau_v8.debug.js" type="text/javascript"></script> 
	<script src="//code.jquery.com/ui/1.11.2/jquery-ui.js"></script>
  </head>

  <body onload=initializeViz();>
	
    <h1><center>Monthly Operations Review</center></h1>
	<h3><font color=#000000><center>Preporting Period: <i>"May 2017"</i></center></font></h3>
	<h3><center><i>(Requires Chrome and Webcam or Microphone)</center></i></h3>
	<h3><center>Say "<i>Total Resource</i>","<i>Start Over</i>","<i>Export</i><i>..... for more Voice commands, click on menu button.</i>"</center></h3>
	<br>
<div id="audio"></div>

<center><div id=tableauViz></div></center>

<script>
if (annyang) {
  //<h5><i>Visualization Created by <a href="https://twitter.com/hemangbhavasar" target="_blank"><span class="Name"><i>HEMANG //BHAVASAR	</i></span></a> 
	//</i></h5> Previous Heading
  // These are the voice commands in quotes followed by the function
  var commands = {
  	'show all': function() { startover(); responsiveVoice.speak('showing all','UK English Male'); },
  	'select all': function() { startover(); responsiveVoice.speak('selecting all','UK English Male'); },
	'India Resource': function() { filterIndia(); responsiveVoice.speak('In India You have Total 22 resource, in which 19 are Permanent employee 2 are shadow employee and 1 is on contract','UK English Male'); },
    	'UK Resource': function() { filterUK(); responsiveVoice.speak('In United Kingdom, You have Total 2 resource, in which both 2 are Permanent employee','UK English Male'); },
    	'USA Resource': function() { filterUSA(); responsiveVoice.speak('In United State of America, You have Total 20 resource, in which 15 are Permanent employee and 5 are on contract','UK English Male'); },
    'Total Resource': function() { filterTR(); responsiveVoice.speak('Globally You have Total 39 resource, in which 31 are  permanent employee, 6 are on contract and 2 are shadow employee','UK English Male'); },    
   'First Highlight': function() { filterH1(); responsiveVoice.speak('Your First Highlight point is, Completed deployment of HRA to Production. XYZ Sr. Manager sent praises,  appreciating ABC.ABC,ABC and Offshore Development plus SQA teams from ABC. He said he can vouch for this team who have always come for rescue and have embraced challenges and delivered on time','UK English Male'); },
    'Second Highlight': function() { filterH2(); responsiveVoice.speak('Your Second Highlight point is, Knowledge Transition Sessions for Sales, Marketing completed as planned for Analytics Factory','UK English Male'); },
    'Third Highlight': function() { filterH3(); responsiveVoice.speak('Your Third Highlight poin is, Similar to HRA 0, we deployed SDH(Sales Data Hub) to Production and received similar appreciations from the XYZ Managers','UK English Male'); },
	   'First Low light': function() { filterL1(); responsiveVoice.speak('Your First Lowlight point is, Signifcant delay in finding an experienced BO resource at Offshore. Longer relieving periods & recent immigration challenges adding up to the delay','UK English Male'); },
    'Second Low light': function() { filterL2(); responsiveVoice.speak('Your Second Lowlight point is, Longer relieving period in India for resources delayed onboarding the Offshore Architect and she is joining the team for Jan 2018','UK English Male'); },
     'Third Low light': function() { filterL3(); responsiveVoice.speak('Currently You do not have any Third Lowlight','UK English Male'); },
   'export': function() { exportPDF(); responsiveVoice.speak('exporting','UK English Male'); },
	'start over': function() { startover(); responsiveVoice.speak('starting over','UK English Male'); },
	'remove filter': function() { removeFilter(); responsiveVoice.speak('removing filter','UK English Male'); },
	'remove filters': function() { removeFilter(); responsiveVoice.speak('removing filters','UK English Male'); } 
 };
  
  // Add commands to annyang
  annyang.addCommands(commands);

  // Start listening.
  annyang.start();
}
</script>

<script>

var viz, workbook, activeSheet, Worksheet, worksheet;;
function initializeViz(){

var placeholderDiv = document.getElementById("tableauViz");

var url = "https://public.tableau.com/views/MORDashboardwithVoice/MainDashboard?:embed=y&:display_count=yes&:tabs=yes:showVizHome=no";
var options = {
   width: "1055px",   
   height: "869px",
   hideTabs: false,
   hideToolbar: true,
  onFirstInteractive: function () {
  workbook = viz.getWorkbook();
  activeSheet = workbook.getActiveSheet();
}
};
  viz = new tableauSoftware.Viz(placeholderDiv, url, options);
  
  }

responsiveVoice.speak('Hi. My name is Hemang. Welcome to Monthly Operations Review Meeting, May 2017. How can I help you?','UK English Male');


//Filter States

function showAll()
{
activeSheet.getWorksheets()[1].applyFilterAsync("State", "", tableauSoftware.FilterUpdateType.REPLACE);
activeSheet.getWorksheets()[0].applyFilterAsync("Time of day", "", tableauSoftware.FilterUpdateType.REPLACE);
}

function filterIndia()
{
activeSheet.getWorksheets()[0].applyFilterAsync('Country', 'India', tableauSoftware.FilterUpdateType.REPLACE); 
}

  function filterUK()
{
activeSheet.getWorksheets()[0].applyFilterAsync('Country', 'United Kingdom', tableauSoftware.FilterUpdateType.REPLACE); 
}
 
  function filterUSA()
{
activeSheet.getWorksheets()[0].applyFilterAsync('Country', 'USA', tableauSoftware.FilterUpdateType.REPLACE); 
}
  
    function filterTR()
{
activeSheet.getWorksheets()[0].applyFilterAsync('Country',['USA', 'India', 'UK'], tableauSoftware.FilterUpdateType.REPLACE); 
}
  
  function filterH1()
{
activeSheet.getWorksheets()[0].applyFilterAsync('Sr No.', '1', tableauSoftware.FilterUpdateType.REPLACE); 
}
  
  function filterH2()
{
activeSheet.getWorksheets()[0].applyFilterAsync('Sr No.', '2', tableauSoftware.FilterUpdateType.REPLACE); 
}
  
  function filterH3()
{
activeSheet.getWorksheets()[0].applyFilterAsync('Sr No.', '3', tableauSoftware.FilterUpdateType.REPLACE); 
}
    

    function filterL1()
{
activeSheet.getWorksheets()[0].applyFilterAsync('Sr No.', '1', tableauSoftware.FilterUpdateType.REPLACE); 
}
  
  function filterL2()
{
activeSheet.getWorksheets()[0].applyFilterAsync('Sr No.', '2', tableauSoftware.FilterUpdateType.REPLACE); 
}
  
  
 // function selectIndia()
//	{
//	activeSheet.getWorksheets()[1].selectMarksAsync('Sr No.', '1', 'REPLACE'); 
//	}
  
<!-- activeSheet.getWorksheets()[0].selectMarksAsync('Time of day', 'Day', tableauSoftware.FilterUpdateType.REPLACE);  -->

function removeFilter()
{
activeSheet.getWorksheets()[0].applyFilterAsync('Sr No.', ['1', '2', '3'],tableauSoftware.FilterUpdateType.ALL); 
}


//UI Control

function exportPDF()
{

viz.showExportPDFDialog();
}

function startover()
{

viz.revertAllAsync();
}

</script>

  </body>
</html>
