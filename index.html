<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />

<title>MOR Dashboard</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="When birds and planes collide...">
    <meta name="author" content="Jeffrey Shaffer">

  <!-- <link rel="stylesheet" href="leapstrap.css" /> -->
  <!-- <link rel="stylesheet" href="example.css" /> -->
	
	<script src="annyang.min.js"></script>
	<script src="responsivevoice.js"></script>

	<script src="https://public.tableausoftware.com/javascripts/api/tableau_v8.debug.js" type="text/javascript"></script> 
	<script src="//code.jquery.com/ui/1.11.2/jquery-ui.js"></script>
  </head>

  <body onload=initializeViz();>
	
    <h1><center>Monthly Operations Review</center></h1>
	<h3><font color=#000000><center>Preporting Period: <i>"May 2017"</i></center></font></h3>
	<h3><center><i>(Requires Chrome and Webcam or Microphone)</center></i></h3>
	<h3><center>Say "<i>Total Resource</i>","<i>Start Over</i>","<i>Export</i><i>..... for more Voice commands, click on menu button.</i>"</center></h3>
	<br>
<div id="audio"></div>

<center><div id=tableauViz></div></center>

<script>
if (annyang) {
  //<h5><i>Visualization Created by <a href="https://twitter.com/hemangbhavasar" target="_blank"><span class="Name"><i>HEMANG //BHAVASAR	</i></span></a> 
	//</i></h5> Previous Heading
  // These are the voice commands in quotes followed by the function
  var commands = {
  	
 };
  
  // Add commands to annyang
  annyang.addCommands(commands);

  // Start listening.
  annyang.start();
}
</script>

<script>

var viz, workbook, activeSheet, Worksheet, worksheet;;
function initializeViz(){

var placeholderDiv = document.getElementById("tableauViz");

var url = "https://public.tableau.com/views/MORDashboardwithVoice/MainDashboard?:embed=y&:display_count=yes&:tabs=yes:showVizHome=no";
var options = {
   width: "1065px",   
   height: "869px",
   hideTabs: false,
   hideToolbar: true,
  onFirstInteractive: function () {
  workbook = viz.getWorkbook();
  activeSheet = workbook.getActiveSheet();
}
};
  viz = new tableauSoftware.Viz(placeholderDiv, url, options);
  
  }

responsiveVoice.speak('Hi. My name is Hemang. Welcome to Monthly Operations Review Meeting, May 2017. How can I help you?','UK English Male');


//Filter States

function showAll()
{
activeSheet.getWorksheets()[1].applyFilterAsync("State", "", tableauSoftware.FilterUpdateType.REPLACE);
activeSheet.getWorksheets()[0].applyFilterAsync("Time of day", "", tableauSoftware.FilterUpdateType.REPLACE);
}

function filterIndia()
{
activeSheet.getWorksheets()[0].applyFilterAsync('Country', 'India', tableauSoftware.FilterUpdateType.REPLACE); 
}

  function filterUK()
{
activeSheet.getWorksheets()[0].applyFilterAsync('Country', 'United Kingdom', tableauSoftware.FilterUpdateType.REPLACE); 
}
 
  function filterUSA()
{
activeSheet.getWorksheets()[0].applyFilterAsync('Country', 'USA', tableauSoftware.FilterUpdateType.REPLACE); 
}
  
    function filterTR()
{
activeSheet.getWorksheets()[0].applyFilterAsync('Country',['USA', 'India', 'UK'], tableauSoftware.FilterUpdateType.REPLACE); 
}
  
  function filterH1()
{
activeSheet.getWorksheets()[0].applyFilterAsync('Sr No.', '1', tableauSoftware.FilterUpdateType.REPLACE); 
}
  
  function filterH2()
{
activeSheet.getWorksheets()[0].applyFilterAsync('Sr No.', '2', tableauSoftware.FilterUpdateType.REPLACE); 
}
  
  function filterH3()
{
activeSheet.getWorksheets()[0].applyFilterAsync('Sr No.', '3', tableauSoftware.FilterUpdateType.REPLACE); 
}
    

    function filterL1()
{
activeSheet.getWorksheets()[0].applyFilterAsync('Sr No.', '1', tableauSoftware.FilterUpdateType.REPLACE); 
}
  
    function filterL2()
{
activeSheet.getWorksheets()[0].applyFilterAsync('Sr No.', '2', tableauSoftware.FilterUpdateType.REPLACE); 
}
  
    function filterL3()
{
activeSheet.getWorksheets()[0].applyFilterAsync('Sr No.', '3', tableauSoftware.FilterUpdateType.REPLACE); 
}
  
      function filterKA1()
{
activeSheet.getWorksheets()[0].applyFilterAsync('S.No', '1', tableauSoftware.FilterUpdateType.REPLACE); 
}

        function filterKA2()
{
activeSheet.getWorksheets()[0].applyFilterAsync('S.No', '2', tableauSoftware.FilterUpdateType.REPLACE); 
}
  
        function filterKA3()
{
activeSheet.getWorksheets()[0].applyFilterAsync('S.No', '3', tableauSoftware.FilterUpdateType.REPLACE); 
}
  
   function filterKA4()
{
activeSheet.getWorksheets()[0].applyFilterAsync('S.No', '4', tableauSoftware.FilterUpdateType.REPLACE); 
}
  
   function filterRA1()
{
activeSheet.getWorksheets()[0].applyFilterAsync('S.No', '1', tableauSoftware.FilterUpdateType.REPLACE); 
}
   function filterRA2()
{
activeSheet.getWorksheets()[0].applyFilterAsync('S.No', '2', tableauSoftware.FilterUpdateType.REPLACE); 
}
 
  function filterRA3()
{
activeSheet.getWorksheets()[0].applyFilterAsync('S.No', '3', tableauSoftware.FilterUpdateType.REPLACE); 
}
 
  function filterRA4()
{
activeSheet.getWorksheets()[0].applyFilterAsync('S.No', '4', tableauSoftware.FilterUpdateType.REPLACE); 
}
  
    function filterVA1()
{
activeSheet.getWorksheets()[0].applyFilterAsync('No.', '1', tableauSoftware.FilterUpdateType.REPLACE); 
}
  
    function filterVA2()
{
activeSheet.getWorksheets()[0].applyFilterAsync('No.', '2', tableauSoftware.FilterUpdateType.REPLACE); 
}
  
 // function selectIndia()
//	{
//	activeSheet.getWorksheets()[1].selectMarksAsync('Sr No.', '1', 'REPLACE'); 
//	}
  
<!-- activeSheet.getWorksheets()[0].selectMarksAsync('Time of day', 'Day', tableauSoftware.FilterUpdateType.REPLACE);  -->

function removeFilter()
{
activeSheet.getWorksheets()[0].applyFilterAsync('Sr No.', ['1', '2', '3'],tableauSoftware.FilterUpdateType.ALL); 
}


//UI Control

function exportPDF()
{

viz.showExportPDFDialog();
}

function startover()
{

viz.revertAllAsync();
}

</script>

  </body>
</html>
